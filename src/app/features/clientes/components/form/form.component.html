<p-dialog
    [(visible)]="clienteDialog"
    [style]="{ width: '550px' }"
    [header]="getDialogHeader()"
    [modal]="true"
    [draggable]="false"
    [resizable]="false"
    [closable]="true"
    styleClass="p-fluid">
    <form [formGroup]="clienteForm" (ngSubmit)="saveCliente()">
        <div class="flex justify-content-center mb-3" *ngIf="loading">
            <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
        </div>
        <div class="field mb-3" [style.display]="loading ? 'none' : 'block'">
            <label for="tax_id" class="font-bold mb-2 block">NIT <span class="text-red-500">*</span></label>
            <input
                type="text"
                pInputText
                id="tax_id"
                formControlName="tax_id"
                placeholder="Ingrese el NIT del cliente"
                required
                maxlength="12"
                [ngClass]="{ 'ng-invalid ng-dirty': submitted && clienteForm.get('tax_id')?.invalid }"
                class="w-full" />
            <small class="p-error block mt-1" *ngIf="submitted && clienteForm.get('tax_id')?.invalid">
                El NIT es requerido y debe tener máximo 12 caracteres.
            </small>
        </div>

        <div class="field mb-3" [style.display]="loading ? 'none' : 'block'">
            <label for="name" class="font-bold mb-2 block">Nombre <span class="text-red-500">*</span></label>
            <input
                type="text"
                pInputText
                id="name"
                formControlName="name"
                placeholder="Ingrese el nombre del cliente"
                required
                maxlength="100"
                [ngClass]="{ 'ng-invalid ng-dirty': submitted && clienteForm.get('name')?.invalid }"
                class="w-full" />
            <small class="p-error block mt-1" *ngIf="submitted && clienteForm.get('name')?.invalid">
                El nombre es requerido y debe tener máximo 100 caracteres.
            </small>
        </div>

        <div class="field mb-3" [style.display]="loading ? 'none' : 'block'">
            <label for="address" class="font-bold mb-2 block">Dirección <span class="text-red-500">*</span></label>
            <textarea
                rows="3"
                cols="30"
                pTextarea
                id="address"
                formControlName="address"
                placeholder="Ingrese la dirección del cliente"
                required
                [ngClass]="{ 'ng-invalid ng-dirty': submitted && clienteForm.get('address')?.invalid }"
                class="w-full">
            </textarea>
            <small class="p-error block mt-1" *ngIf="submitted && clienteForm.get('address')?.invalid">
                La dirección es requerida.
            </small>
        </div>

        <div class="field mb-3" [style.display]="loading ? 'none' : 'block'">
            <label for="contact_email" class="font-bold mb-2 block">Email de Contacto <span class="text-red-500">*</span></label>
            <input
                type="email"
                pInputText
                id="contact_email"
                formControlName="contact_email"
                placeholder="ejemplo@correo.com"
                required
                [ngClass]="{ 'ng-invalid ng-dirty': submitted && clienteForm.get('contact_email')?.invalid }"
                class="w-full" />
            <small class="p-error block mt-1" *ngIf="submitted && clienteForm.get('contact_email')?.invalid">
                El email es requerido y debe ser válido.
            </small>
        </div>

        <div class="field mb-3" [style.display]="loading ? 'none' : 'block'">
            <label for="enabled" class="font-bold mb-2 block">Estado</label>
            <div class="flex align-items-center gap-2">
                <p-toggleswitch id="enabled" formControlName="enabled"></p-toggleswitch>
                <span class="text-sm">{{ clienteForm.get('enabled')?.value ? 'Activo' : 'Inactivo' }}</span>
            </div>
        </div>
    </form>

    <ng-template pTemplate="footer">
        <div class="flex justify-content-end gap-2">
            <button
                pButton
                pRipple
                type="button"
                label="Cancelar"
                icon="pi pi-times"
                severity="secondary"
                [outlined]="true"
                [disabled]="loading"
                (click)="hideDialog()">
            </button>
            <button
                pButton
                pRipple
                type="button"
                [label]="isEditing ? 'Actualizar' : 'Guardar'"
                icon="pi pi-check"
                [disabled]="loading"
                (click)="saveCliente()">
            </button>
        </div>
    </ng-template>
</p-dialog>

<p-toast></p-toast>
